name: REACT CI

on:
  pull_request:
      branches:
           - main

jobs:
    Jest:
        runs-on: [ubuntu-latest] # 최신 우분투 가상환경 사용
        strategy:
          matrix:
            node-version: [14.x] # ".x" 로 최신 버전도 사용하고 직접 버전 지정도 가능하다
        steps:
          - uses: actions/checkout@v2
          - name: Use Node.js ${{ matrix.node-version }}
            uses: actions/setup-node@v1
            with:
              node-version: ${{ matrix.node-version }}
          - name: ======== YANR INSTALL ========
            run: |
              npm i -g yarn &&
              yarn install --frozen-lockfile
          - name: ======== TEST START ========
            run: |
              yarn test
          - name: ======== TEST FAIL ========
            uses: actions/github-script@v5
            with:
              github-token: ${{secrets.GITHUB_TOKEN}}
              script: |
                const ref = "${{github.ref}}"
                const pull_number = Number(ref.split("/")[2])
                await  github.rest.issues.createComment({
                  issue_number: context.issue.number,
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  body: '🔥 테스트 코드를 확인해주세요.'
                })
            if: failure()
          - name: ======== TEST SUCCESS ========
            run: echo successsssssssssssssss!!
            if: success()

